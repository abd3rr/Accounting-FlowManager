<!DOCTYPE html>
<html lang="fr" layout:decorate="~{layout}" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <title>Aperçu de la Facture</title>
</head>
<body>
<div layout:fragment="content">
    <main class="container mt-5">
        <div class="invoice-container">
            <h1 class="mb-4 text-center">Aperçu de la Facture</h1>

            <div class="invoice-header row mb-4">
                <div class="col-md-6">
                    <h4>Détails du Client</h4>
                    <p><strong>Nom:</strong> <span th:text="${previewDTO.clientName}">Nom du Client</span></p>
                    <p><strong>Adresse:</strong> <span th:text="${previewDTO.clientAddress}">Adresse du Client</span></p>
                    <p><strong>Pays:</strong> <span th:text="${previewDTO.clientCountry}">Pays du Client</span></p>
                    <p><strong>Email:</strong> <span th:text="${previewDTO.clientEmail}">Email du Client</span></p>
                </div>
                <div class="col-md-6">
                    <h4>Détails du Fournisseur</h4>
                    <p><strong>Nom:</strong> <span th:text="${previewDTO.providerName}">Nom du Fournisseur</span></p>
                    <p><strong>Adresse:</strong> <span th:text="${previewDTO.providerAddress}">Adresse du Fournisseur</span></p>
                    <p><strong>Pays:</strong> <span th:text="${previewDTO.providerCountry}">Pays du Fournisseur</span></p>
                    <p><strong>Email:</strong> <span th:text="${previewDTO.providerEmail}">Email du Fournisseur</span></p>
                </div>
            </div>

            <h4 class="mb-3">Détails des Produits</h4>
            <table class="table table-striped">
                <thead>
                <tr>
                    <th>Nom du Produit</th>
                    <th>Quantité</th>
                    <th>Prix Unitaire</th>
                    <th>Prix Total</th>
                    <th>Devise</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="product : ${previewDTO.products}">
                    <td th:text="${product.productName}">Nom du Produit</td>
                    <td th:text="${product.quantity}">Quantité</td>
                    <td th:text="${product.unitPrice}">Prix Unitaire</td>
                    <td th:text="${product.totalPrice}">Prix Total</td>
                    <td th:text="${product.currency}">Devise</td>
                </tr>
                </tbody>
            </table>

            <h4 class="mb-3">Résumé de la Facture</h4>
            <table class="table table-bordered">
                <tbody>
                <tr>
                    <th>Réduction</th>
                    <td><span th:text="${previewDTO.reduction * 100}">0</span>% (<span th:text="${previewDTO.reduction * previewDTO.totalHT}">0</span> EUR)</td>
                </tr>
                <tr>
                    <th>Réduction Supplémentaire</th>
                    <td><span th:text="${previewDTO.additionalReductionType.displayName}">Type de Réduction</span> : <span th:text="${previewDTO.additionalReduction * 100}">0</span>% (<span th:text="${previewDTO.additionalReduction * previewDTO.totalHT}">0</span> EUR)</td>
                </tr>
                <tr>
                    <th>Type de Coût de Livraison</th>
                    <td th:text="${previewDTO.shippingCostType.displayName}">Type de Coût de Livraison</td>
                </tr>
                <tr>
                    <th>Coût de Livraison</th>
                    <td><span th:text="${previewDTO.shippingCost}">0</span> EUR</td>
                </tr>
                <tr>
                    <th>Acompte</th>
                    <td><span th:text="${previewDTO.advancePayment}">0</span> EUR</td>
                </tr>
                <tr>
                    <th>Total HT</th>
                    <td><span th:text="${previewDTO.totalHT}">0</span> EUR</td>
                </tr>
                <tr>
                    <th>TVA</th>
                    <td><span th:text="${previewDTO.tva}">0</span>% (<span th:text="${previewDTO.totalHT * (previewDTO.tva / 100)}">0</span> EUR)</td>
                </tr>
                <tr>
                    <th>Total TTC</th>
                    <td><span th:text="${previewDTO.totalTTC}">0</span> EUR</td>
                </tr>
                </tbody>
            </table>

            <div class="mt-4 btn-group">
                <button class="btn btn-danger" onclick="history.back()">Annuler</button>
                <a th:href="@{/invoice/create}" class="btn btn-success">Valider</a>
            </div>
        </div>
    </main>
</div>
</body>
</html>
